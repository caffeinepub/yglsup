{
  "kind": "coverage_report",
  "version": "1.0",
  "generatedAt": "2026-02-12T08:06:43.754Z",
  "sources": {
    "buildRequest": true,
    "implementationPlan": true
  },
  "requirements": {
    "total": 4,
    "implemented": 2,
    "items": [
      {
        "id": "REQ-1",
        "summary": "Fix the outgoing call WebRTC/signaling flow so that the same RTCPeerConnection used to generate the SDP offer is the one that later applies the SDP answer, and ensure the backend-stored offer/answer lifecycle results in a connected call between two different users.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/features/chat/MessageThread.tsx",
          "frontend/src/features/calls/CallProvider.tsx",
          "frontend/src/features/calls/CallScreen.tsx",
          "frontend/src/features/calls/IncomingCallManager.tsx"
        ],
        "matchedFiles": [
          "frontend/src/features/chat/MessageThread.tsx",
          "frontend/src/features/calls/CallProvider.tsx",
          "frontend/src/features/calls/CallScreen.tsx",
          "frontend/src/features/calls/IncomingCallManager.tsx"
        ]
      },
      {
        "id": "REQ-2",
        "summary": "Fix incoming call detection end-to-end in production by ensuring the backend exposes a working getPendingIncomingCalls() query for the authenticated user and that it returns only actionable incoming calls (e.g., initiated/ringing where caller != callee) so the frontend polling can reliably show the incoming call dialog.",
        "status": "unknown",
        "plannedFiles": [],
        "matchedFiles": []
      },
      {
        "id": "REQ-3",
        "summary": "Align backend call lifecycle semantics with the frontend call flow by enforcing consistent and valid status transitions for startCall, answerCall, and updateCallStatus, including correct status after answering and protection against invalid transitions by non-participants.",
        "status": "unknown",
        "plannedFiles": [],
        "matchedFiles": []
      },
      {
        "id": "REQ-4",
        "summary": "Improve call failure visibility on the frontend so users and developers can diagnose why calls fail in production (permissions, backend traps, signaling missing offer/answer) without changing any immutable hook files.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/features/calls/useCallSignaling.ts",
          "frontend/src/features/calls/useIncomingCallPolling.ts",
          "frontend/src/features/calls/CallScreen.tsx",
          "frontend/src/features/calls/IncomingCallManager.tsx",
          "frontend/src/features/calls/CallChip.tsx"
        ],
        "matchedFiles": [
          "frontend/src/features/calls/useCallSignaling.ts",
          "frontend/src/features/calls/useIncomingCallPolling.ts",
          "frontend/src/features/calls/CallScreen.tsx",
          "frontend/src/features/calls/IncomingCallManager.tsx",
          "frontend/src/features/calls/CallChip.tsx"
        ]
      }
    ]
  },
  "changedFiles": [
    "backend/main.mo",
    "backend/migration.mo",
    "build-request.json",
    "feature_evidence.json",
    "frontend-file-summaries.txt",
    "frontend-implementation-plan.json",
    "frontend/src/backend.d.ts",
    "frontend/src/backend.ts",
    "frontend/src/declarations/backend.did.d.ts",
    "frontend/src/declarations/backend.did.js",
    "frontend/src/features/calls/CallChip.tsx",
    "frontend/src/features/calls/CallProvider.tsx",
    "frontend/src/features/calls/CallScreen.tsx",
    "frontend/src/features/calls/IncomingCallManager.tsx",
    "frontend/src/features/calls/useCallSignaling.ts",
    "frontend/src/features/calls/useIncomingCallPolling.ts",
    "frontend/src/features/chat/MessageThread.tsx",
    "project_state.json",
    "scratch/component-selection.json",
    "spec.md",
    "spec_vs_diff_report.json"
  ]
}